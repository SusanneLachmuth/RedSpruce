"section","subsection","element","Value"
"Overview","Authorship","Study title","Title: From the last glacial maximum to the end of the 21th century: the journey of a montane tree species"
"Overview","Authorship","Author names","Thibaut Capblancq; Susanne Lachmuth; Matthew Fitzpatrick; Stephen Keller"
"Overview","Authorship","Contact ","susanne.lachmuth@umces.edu"
"Overview","Authorship","Study link","Publication in prep."
"Overview","Model objective","Model objective","Forecast and transfer"
"Overview","Model objective","Target output","Continuous climate suitability index"
"Overview","Focal Taxon","Focal Taxon","Picea rubens Sarg."
"Overview","Location","Location","Eastern North America (United States and Canada)"
"Overview","Scale of Analysis","Spatial extent","-100, -48, 20, 60 (xmin, xmax, ymin, ymax)"
"Overview","Scale of Analysis","Spatial resolution","0.5°"
"Overview","Scale of Analysis","Temporal extent","Occurrence data extend from 1877 to present, climate data extend from 20 ka BP to 2090 CE."
"Overview","Scale of Analysis","Temporal resolution","We used 200‐year averages of paleoclimate centered on five target time slices (1, 5, 10, 15 and 20 k a BP), 150-year averages (1850 to 1990 CE) of contemporary climate as well as 20-year averages (2081-2100 CE) of future climate."
"Overview","Scale of Analysis","Boundary","natural; rectangle"
"Overview","Biodiversity data","Observation type","field survey; standardised monitoring data; citizen science"
"Overview","Biodiversity data","Response data type","presence/absence"
"Overview","Predictors","Predictor types","climatic"
"Overview","Hypotheses","Hypotheses","The geographic distribution of tree species in temperate climate zones is determined by growing season temperatures, climatic water balance, and seasonality (Metzger et al. 2013). Accordingly, we chose six ecologically meaningful predictor variables that contemporarily show considerable variation and low collinearity across the study region and have a high potential for delineating the range limits of Picea rubens. 

Reference: Metzger, M.J., Bunce, R.G.H., Jongman, R.H.G., Sayre, R., Trabucco, A. & Zomer, R. (2013). A high-resolution bioclimate map of the world: a unifying framework for global biodiversity research and monitoring. Global Ecology and Biogeography, 22, 630–638."
"Overview","Assumptions","Model assumptions","-	Red spruce distribution is in pseudo-equilibrium with the environment
-	Occurrence data are free from observational bias
-	Each occurrence record represents an independent observation
-	Key predictors are incorporated in the model
-	Predictors are estimated without error 
-	No spatial auto-correlation of residuals
-	Red spruce retains its niche across space and time 
-	Relationships fitted under current conditions apply when transferring predictions, even when projected beyond the range of the training data; no change in correlation structure of environmental variables; no change in key limiting processes"
"Overview","Algorithms","Modelling techniques","glm; gam; mars; brt; randomForest; fda; maxent"
"Overview","Algorithms","Model complexity","The model settings were chosen to yield relatively simple response surfaces because we attempted hindcasting to the Last Glacial Maximum and forecasting to the end of the 21st century. The species may not be at equilibrium with the environment and non-analogous climates have been projected for some target time periods and geographic regions (to a very moderate degree, see Supplementary Material 3). We allowed quadratic relationships in GLMs and GAMs, and restricted MARS, FDAs, BRTs, RFs and MaxEnt models in a way to avoid overfitting."
"Overview","Algorithms","Model averaging","We combined the seven types of algorithms in an ensemble approach."
"Overview","Workflow","Model workflow","We used variance inflation (VIF) and pair-wise correlation analyses to avoid high collinearity among predictors. With six selected climatic variables, we fit ecological niche models using seven different algorithms (GLM, GAM, MARS, FDA, RF, GBM, Maxent). Ensemble mean projections of current climate suitability as well as ensemble hindcasts and forecasts for the five historical and one future target time slices were obtained from twenty split-validation runs with 70% of occurrence data used to calibrate, and 30% used to evaluate the models based on AUC , TSS and Kappa statistics as well as calibration plots. We estimated variable importance and produced partial response curves and map displays for visualization and assessment of ecological plausibility."
"Overview","Software","Software","Software: R (version 3.6.1), session info including package versions is available here: https://github.com/SusanneLachmuth/RedSpruce
"
"Overview","Software","Code availability","Code is available here: https://github.com/SusanneLachmuth/RedSpruce"
"Overview","Software","Data availability","Data are available here: https://github.com/SusanneLachmuth/RedSpruce"
"Data","Biodiversity data","Taxon names","Picea rubens Sarg. (Pinaceae)"
"Data","Biodiversity data","Taxonomic reference system","Catalogue of Life: 2020-04-16 Beta"
"Data","Biodiversity data","Ecological level","species"
"Data","Biodiversity data","Data sources","We collected Picea rubens occurrence data from various sources including from the Botanical Information and Ecology Network – BIEN , the Biodiversity Information Serving Our Nation (BISON) database, the Natural Heritage Vegetation Database for West Virginia, the Global Biodiversity Information Facility  as well as US and Canadian forest inventory programs to complement our own sampling locations. Details and references for the downloaded data sets are given in Supplementary Material 2."
"Data","Biodiversity data","Sampling design","Random"
"Data","Biodiversity data","Sample size","Prevalence / sample size after thinning: 304 / 1684"
"Data","Biodiversity data","Clipping",""
"Data","Biodiversity data","Scaling","Raw data were thinned to one record per grid cell."
"Data","Biodiversity data","Cleaning","We excluded outlier data points from federal states in which the species is not reported to occur based on the ""Flora of North America / Little"", photo plots from the Canadian forest inventory program as well as data types of the following categories: ""unknown"", ""fossil"", ""living specimen"" (e.g. in botanical gardens). Data were than thinned to the resolution of the climate data (0.5°), which lead to the removal duplicates. Grid cells were set to 'present' as soon as a presence had been reported anywhere within the cell. Grid cells occupied by water bodies were removed except if they held presence data points."
"Data","Biodiversity data","Absence data","Non-observation of species in US and Canadian forest inventory programs was treated as absence"
"Data","Biodiversity data","Background data","In the implementation used (Guisan et al. 2017) MaxEnt used 0.5°C ASCII grids of our climatic layers to define the available environmental space for the MaxEnt probability distribution and then created 10000 randomly selected background points. 
Reference: Guisan, A., Thuiller, W. & Zimmermann, N.E. (2017). Habitat Suitability and Distribution Models: With Applications in R. Ecology, Biodiversity and Conservation. Cambridge University Press, Cambridge, U.K."
"Data","Biodiversity data","Errors and biases",""
"Data","Data partitioning","Training data","We applied twenty split-validation runs with 70% of occurrence data used to calibrate, and 30% used to evaluate the models."
"Data","Data partitioning","Validation data","We applied twenty split-validation runs with 70% of occurrence data used to calibrate, and 30% used to evaluate the models."
"Data","Data partitioning","Test data","N/A"
"Data","Predictor variables","Predictor variables","As model inputs we used a unified set of climatic variables from debiased and downscaled Community Climate System Model Version 3 (CCSM3) simulations for North America  as presented by (Lorenz et al. 2016): mean summer precipitation (jja_sum_PRCP) , mean annual precipitation (an_sum_PRCP), mean annual growing degree days  with a base of 5°C (an_sum_GDD5), mean annual water deficit (an_sum_WDI), annual variation in precipitation (an_cv_PRCP), and annual variation in GDD5 (an_sd_GDD5).
Reference: Lorenz, D.J., Nieto-Lugilde, D., Blois, J.L., Fitzpatrick, M.C. & Williams, J.W. (2016). Downscaled and debiased climate simulations for North America from 21,000 years ago to 2100AD. Sci Data, 3, 1–19."
"Data","Predictor variables","Data sources","https://datadryad.org/stash/dataset/doi:10.5061/dryad.1597g"
"Data","Predictor variables","Spatial extent","-100, -48, 20, 60 (xmin, xmax, ymin, ymax)"
"Data","Predictor variables","Spatial resolution","0.5°"
"Data","Predictor variables","Coordinate reference system","+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"
"Data","Predictor variables","Temporal extent","1850 to 1990 CE"
"Data","Predictor variables","Temporal resolution","We extracted 150-year averages (1850 to 1990 CE) of contemporary climate variables."
"Data","Predictor variables","Data processing","See original publication:  Lorenz, D. J. et al. Downscaled and debiased climate simulations for North America from 21,000 years ago to 2100AD. Sci. Data 3:160048 doi: 10.1038/sdata.2016.48 (2016)"
"Data","Predictor variables","Errors and biases",""
"Data","Predictor variables","Dimension reduction","Among all available climatic variables we chose six ecologically relevant variables that contemporarily show considerable variation and low collinearity (pairwise Pearson’s r < 0.7) across our study region."
"Data","Transfer data","Data sources","https://datadryad.org/stash/dataset/doi:10.5061/dryad.1597g"
"Data","Transfer data","Spatial extent","-100, -48, 20, 60 (xmin, xmax, ymin, ymax)"
"Data","Transfer data","Spatial resolution","0.5°"
"Data","Transfer data","Temporal extent","1 to 20 ka BP and 2081-2100 CE"
"Data","Transfer data","Temporal resolution","We extracted 200‐year averages of paleoclimatic variables centered on five target time slices (1, 5, 10, 15 and 20 ka BP) and 20-year averages of future climate centered on 2090 CE."
"Data","Transfer data","Models and scenarios","See original publication:  Lorenz, D. J. et al. Downscaled and debiased climate simulations for North America from 21,000 years ago to 2100AD. Sci. Data 3:160048 doi: 10.1038/sdata.2016.48 (2016)"
"Data","Transfer data","Data processing","We masked cells that were covered by water bodies or the Laurentide Ice Sheet at a given point in time based on shapefiles of glacial data from Dyke et al. (2003) rasterized to match the scale, resolution and projection of the climate data. For further detail on data processing and scaling see original publication:  Lorenz, D. J. et al. Downscaled and debiased climate simulations for North America from 21,000 years ago to 2100AD. Sci. Data 3:160048 doi: 10.1038/sdata.2016.48 (2016).
Reference: Dyke, A.S., Moore, A. & Robertson, L. (2003). Deglaciation of North America. Thirty-two maps at 1:70000000 scale with accompanying digital chronological database and one poster (in two sheets) with full map series. Geol. Surv. Can. Tech. Rep. - Open File 1574. Government of Canada."
"Data","Transfer data","Quantification of Novelty","We used the ‘novel’ function of MaxEnt (version 3.4.0) to quantify the novelty of climatic conditions for our five hindcast and one forecast target time slices (1, 5, 10, 15 and 20 ka BP, 2090 CE) in relation to the contemporary climate across our study region.
Reference: Phillips, S. J. 2017. A Brief Tutorial on Maxent. Available from url: http://biodiversityinformatics.amnh.org/open_source/maxent/.Accessed on 2020-07-09."
"Model","Variable pre-selection","Variable pre-selection","We first replaced all quarterly variables provided by Lorenz et al. (2016) with seasonal variables (DJF, MAM, JJA, SON) in order to guarantee analogy of the quarters across space and time. Calculation of these variables was based on the same methods as described by Lorenz et al. (2016). We then excluded all monthly variables since they were highly correlated with both the corresponding quarterly and annual variables. Moreover, among closely related sets of variables (e.g. growing degree days with different bases or evapotranspiration and water deficit variables), we chose the ecologically most relevant (growing degree days with a base of 5°C and water deficit index (WDI)). We excluded variables that showed hardly any variation across the study region or had high amounts of missing data (an_cv_WDI, an_cv_ETR)."
"Model","Multicollinearity","Multicollinearity","In order to reduce collinearity in the remaining data set we applied a step-wise variable elimination based on the Variance Inflation Factor (vifstep, R package usdm), which yielded five variables with a VIF < 0.6 (mean summer precipitation (jja_sum_PRCP), mean annual precipitation (an_sum_PRCP), mean annual water deficit (an_sum_WDI), annual variation in precipitation (an_cv_PRCP), and annual variation in GDD5 (an_sd_GDD5). However, we had concerns that this variable set would not adequately represent ecologically highly relevant growing season temperatures and therefore added mean annual growing degree days (an_sum_GDD5). This addition increased the VIF of some variables to above 10. However, pairwise correlations between all predictors remained < 0.7 (Pearson’s r)."
"Model","Model settings","Model settings (fitting)","glm: family (binomial), formula (makeFormula(""PresAbs"",data[,c(""jja_sum_PRCP"", ""an_sum_PRCP"", ""an_sum_GDD5"", ""an_sum_WDI"", ""an_cv_PRCP"", ""an_sd_GDD5"")],""quadratic"",interaction.level=0)), notes (stepwise model selection based on AIC (both directions), linear terms were not allowed to drop out); gam: family (binomial), formula (makeFormula(""PresAbs"",data[,c(""jja_sum_PRCP"", ""an_sum_PRCP"", ""an_sum_GDD5"", ""an_sum_WDI"", ""an_cv_PRCP"", ""an_sd_GDD5"")],""s"",c(2,3))), smoothTerms (s_smoother (2, 3)	), method (GCV.Cp), select (FALSE), notes (stepwise model selection based on AIC (both directions), linear terms were not allowed to drop out); mars: formula (~ 1+ jja_sum_PRCP + an_sum_PRCP + an_sum_GDD5 + an_sum_WDI + an_cv_PRCP + an_sd_GDD5), degree (1), penalty (2), nk (default: min(200, max(20, 2 * ncol(x))) + 1 ), thresh (0.001), pmethod (exhaustive), nfold (10); brt: formula (~ jja_sum_PRCP + an_sum_PRCP + an_sum_GDD5 + an_sum_WDI + an_cv_PRCP + an_sd_GDD5), distribution (bernoulli), nTrees (10000), interactionDepth (7), shrinkage (0.0015), bagFraction (0.6), trainFraction (1), cvFolds (10); randomForest: ntree (1000), mtry (default: if (!is.null(y) && !is.factor(y)) max(floor(ncol(x)/3), 1) else floor(sqrt(ncol(x)))); fda: formula (~ 1+ jja_sum_PRCP + an_sum_PRCP + an_sum_GDD5 + an_sum_WDI + an_cv_PRCP + an_sd_GDD5), method (bruto); maxent: featureSet (linear, quadratic, product), maximumIterations (10000), betamultiplier (1), defaultprevalence (0.2)"
"Model","Model settings","Model settings (extrapolation)",""
"Model","Model estimates","Coefficients",""
"Model","Model estimates","Parameter uncertainty",""
"Model","Model estimates","Variable importance","We quantified the predictors’ relative importance consistently across all model types. To this end, we calculated the inverse of Spearman rank correlation coefficients between probabilities of occurrence predicted by the models using permuted predictor values and predictions based on the original data. See Figure S6 (Supplement 3)."
"Model","Model selection - model averaging - ensembles","Model selection","An information-theoretic approach was used  for GLM, GAM, MARS (model selection based on AIC), shrinkage for GBM, default regularization for MaxEnt (after exploring a range of values for the beta multiplier)."
"Model","Model selection - model averaging - ensembles","Model averaging","Consensus predictions were generated across seven model algorithms and 20 split-validation runs using un-weighted ensemble means."
"Model","Model selection - model averaging - ensembles","Model ensembles",""
"Model","Analysis and Correction of non-independence","Spatial autocorrelation","Just for glm: We did not find significant auto-correlation in residuals of models that included the selected predictor variables and their second order polynomials (but in null model). Tests were done using the R package DHARMa."
"Model","Analysis and Correction of non-independence","Temporal autocorrelation",""
"Model","Analysis and Correction of non-independence","Nested data",""
"Model","Threshold selection","Threshold selection","Thresholds for TSS and Kappa  were optimized using the function 'Find.Optim.Stat' (R package biomod2)"
"Assessment","Performance statistics","Performance on training data","AIC; AUC"
"Assessment","Performance statistics","Performance on validation data","AUC; Kappa; TSS; Calibration plots"
"Assessment","Performance statistics","Performance on test data",
"Assessment","Plausibility check","Response shapes","Partial response curves"
"Assessment","Plausibility check","Expert judgement","Map display"
"Prediction","Prediction output","Prediction unit","Probability of occurrence in four 0.25 bins as required for the follow-up splatche2 runs."
"Prediction","Prediction output","Post-processing","N/A"
"Prediction","Uncertainty quantification","Algorithmic uncertainty",""
"Prediction","Uncertainty quantification","Input data uncertainty",""
"Prediction","Uncertainty quantification","Parameter uncertainty",""
"Prediction","Uncertainty quantification","Scenario uncertainty","For uncertainty in the climate input variables please refer to the original publication:  Lorenz, D. J. et al. Downscaled and debiased climate simulations for North America from 21,000 years ago to 2100AD. Sci. Data 3:160048 doi: 10.1038/sdata.2016.48 (2016)"
"Prediction","Uncertainty quantification","Novel environments","Map display of climatic novelty for the five historic (1, 5, 10, 15 and 20 k a BP) and one future (2090 CE) target time slices. See Supplementary Material 3."
